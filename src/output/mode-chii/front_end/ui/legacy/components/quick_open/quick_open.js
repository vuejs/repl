import*as e from"../../../../core/common/common.js";import*as t from"../../../../core/host/host.js";import*as i from"../../../../core/i18n/i18n.js";import*as r from"../../../../core/platform/platform.js";import*as s from"../../../../third_party/diff/diff.js";import*as o from"../../legacy.js";import*as n from"../../../../models/text_utils/text_utils.js";import*as l from"../../../components/text_prompt/text_prompt.js";import*as a from"../../../components/icon_button/icon_button.js";const d=new CSSStyleSheet;d.replaceSync('.filtered-list-widget{display:flex;flex-direction:column;flex:auto;border:1px solid transparent;--override-filtered-list-widget-highlight-text-background-color:rgb(255 255 255 / 25%)}.-theme-with-dark-background .filtered-list-widget,:host-context(.-theme-with-dark-background) .filtered-list-widget{--override-filtered-list-widget-highlight-text-background-color:rgb(255 255 255 / 75%)}.filtered-list-widget-prompt-element{flex:0 0 34px;border:0;margin:0;padding:0 6px;z-index:1;font-size:inherit}devtools-text-prompt{flex:0 0 40px;font-size:14px;font-family:".SFNSDisplay-Regular","Helvetica Neue","Lucida Grande",sans-serif;line-height:16px;padding:12px}.filtered-list-widget-hint{width:100%;flex:0 0 30px;font-size:12px;line-height:30px;padding:0 12px;overflow:hidden;text-overflow:ellipsis;color:var(--color-text-secondary);background:var(--color-background-elevation-1);border-top:1px solid var(--color-details-hairline)}.filtered-list-widget-progress{flex:none;background:rgb(0 0 0 / 20%);height:1px}.filtered-list-widget-progress-bar{background-color:var(--color-primary-variant);height:2px;width:100%;transform:scaleX(0);transform-origin:top left;opacity:100%;transition:none}.filtered-widget-progress-fade{opacity:0%;transition:opacity .5s}.filtered-list-widget .vbox>div.container{flex:auto;overflow-x:hidden;overflow-y:auto}.filtered-list-widget-item-wrapper{color:var(--color-text-primary);display:flex;border-bottom:1px solid var(--color-details-hairline-light);font-family:".SFNSDisplay-Regular","Helvetica Neue","Lucida Grande",sans-serif;padding-left:8px;padding-right:8px}.filtered-list-widget-item-wrapper devtools-icon{align-self:center;flex:none;padding-right:8px}.filtered-list-widget-item-wrapper.selected{background-color:var(--color-primary)}.filtered-list-widget-item{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;align-self:center;font-size:12px;flex:auto}.filtered-list-widget-item.two-rows span.highlight{color:var(--color-primary)}.filtered-list-widget-item.one-row span.highlight{font-weight:700}.filtered-list-widget-item .filtered-list-widget-title{flex:initial;overflow:hidden;text-overflow:ellipsis}.filtered-list-widget-item .filtered-list-widget-subtitle{flex:none;overflow:hidden;text-overflow:ellipsis;color:var(--color-text-secondary);display:flex;white-space:pre}.filtered-list-widget-item .filtered-list-widget-subtitle .first-part{flex-shrink:1000;overflow:hidden;text-overflow:ellipsis}.filtered-list-widget-item-wrapper .tag{padding:0 12px;border-radius:4px;line-height:24px;height:24px;align-self:center;flex-shrink:0}.filtered-list-widget-item-wrapper.selected .filtered-list-widget-item span.highlight{color:var(--color-background);background-color:var(--override-filtered-list-widget-highlight-text-background-color)}.filtered-list-widget-item-wrapper.selected .filtered-list-widget-subtitle,.filtered-list-widget-item-wrapper.selected .filtered-list-widget-title,.filtered-list-widget-item-wrapper.selected .tag{color:var(--color-background)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_document{--icon-color:var(--color-ic-file-document)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_image{--icon-color:var(--color-ic-file-image)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_font{--icon-color:var(--color-ic-file-font)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_script{--icon-color:var(--color-ic-file-script)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_stylesheet{--icon-color:var(--color-ic-file-stylesheet)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_webbundle{--icon-color:var(--color-ic-file-webbundle)}.filtered-list-widget-item-wrapper devtools-icon.ic_file_default{--icon-color:var(--color-ic-file-default)}.filtered-list-widget-item-wrapper.selected devtools-icon{--icon-color:var(--color-background)}.filtered-list-widget-item.one-row{height:36px;line-height:20px;padding-top:8px;padding-bottom:8px;display:flex}.filtered-list-widget-item.one-row .filtered-list-widget-title{padding-right:8px}.filtered-list-widget-item.two-rows{height:45px;padding-top:8px;padding-bottom:8px}.filtered-list-widget-item.two-rows .filtered-list-widget-title{font-weight:700}.not-found-text{height:34px;line-height:34px;padding-left:8px;font-style:italic;color:var(--color-text-disabled);background:var(--color-background-elevation-0)}.quickpick-description{flex:none;overflow:hidden;text-overflow:ellipsis;color:var(--color-text-disabled);padding-left:15px}@media (forced-colors:active){.filtered-list-widget{forced-color-adjust:none;border-color:ButtonText}.filtered-list-widget-item-wrapper .filtered-list-widget-subtitle,.filtered-list-widget-item-wrapper .filtered-list-widget-title,.quickpick-description{color:ButtonText}.filtered-list-widget-item-wrapper.selected{background-color:Highlight}.filtered-list-widget-item-wrapper.selected .filtered-list-widget-item .filtered-list-widget-subtitle,.filtered-list-widget-item-wrapper.selected .filtered-list-widget-item .filtered-list-widget-title{color:HighlightText}devtools-text-prompt{border-color:ButtonText}}\n/*# sourceURL=filteredListWidget.css */\n');const c={quickOpenPrompt:"Quick open prompt",quickOpen:"Quick open",noResultsFound:"No results found"},h=i.i18n.registerUIStrings("ui/legacy/components/quick_open/FilteredListWidget.ts",c),m=i.i18n.getLocalizedString.bind(void 0,h);class p extends(e.ObjectWrapper.eventMixin(o.Widget.VBox)){promptHistory;scoringTimer;filterTimer;loadTimeout;refreshListWithCurrentResult;dialog;query="";inputBoxElement;hintElement;bottomElementsContainer;progressElement;progressBarElement;items;list;itemElementsContainer;notFoundElement;prefix="";provider;queryChangedCallback;constructor(e,t,i){super(!0),this.promptHistory=t||[],this.scoringTimer=0,this.filterTimer=0,this.loadTimeout=0,this.contentElement.classList.add("filtered-list-widget");const r=this.onKeyDown.bind(this);this.contentElement.addEventListener("keydown",r,!0),o.ARIAUtils.markAsCombobox(this.contentElement),this.inputBoxElement=new l.TextPrompt.TextPrompt,this.inputBoxElement.data={ariaLabel:m(c.quickOpenPrompt),prefix:"",suggestion:""},this.inputBoxElement.addEventListener(l.TextPrompt.PromptInputEvent.eventName,this.onInput.bind(this),!1),this.contentElement.appendChild(this.inputBoxElement),this.hintElement=this.contentElement.createChild("div","filtered-list-widget-hint"),this.bottomElementsContainer=this.contentElement.createChild("div","vbox"),this.progressElement=this.bottomElementsContainer.createChild("div","filtered-list-widget-progress"),this.progressBarElement=this.progressElement.createChild("div","filtered-list-widget-progress-bar"),this.items=new o.ListModel.ListModel,this.list=new o.ListControl.ListControl(this.items,this,o.ListControl.ListMode.EqualHeightItems),this.itemElementsContainer=this.list.element,this.itemElementsContainer.classList.add("container"),this.bottomElementsContainer.appendChild(this.itemElementsContainer),this.itemElementsContainer.addEventListener("click",this.onClick.bind(this),!1),this.itemElementsContainer.addEventListener("mouseover",this.onMouseOver.bind(this),!1),o.ARIAUtils.markAsListBox(this.itemElementsContainer),o.ARIAUtils.setControls(this.inputBoxElement,this.itemElementsContainer),o.ARIAUtils.setAutocomplete(this.inputBoxElement,o.ARIAUtils.AutocompleteInteractionModel.list),this.notFoundElement=this.bottomElementsContainer.createChild("div","not-found-text"),this.notFoundElement.classList.add("hidden"),this.setDefaultFocusedElement(this.inputBoxElement),this.provider=e,this.queryChangedCallback=i}static highlightRanges(e,t,i){if(!t)return!1;function r(e,t){const i=s.Diff.DiffWrapper.charDiff(t,e);let r=0;const o=[];for(let e=0;e<i.length;++e){const t=i[e];if(t[0]===s.Diff.Operation.Equal)o.push(new n.TextRange.SourceRange(r,t[1].length));else if(t[0]!==s.Diff.Operation.Insert)return null;r+=t[1].length}return o}if(null===e.textContent)return!1;const l=e.textContent;let a=r(l,t);return a&&!i||(a=r(l.toUpperCase(),t.toUpperCase())),!!a&&(o.UIUtils.highlightRangesWithStyleClass(e,a,"highlight"),!0)}setCommandPrefix(e){this.inputBoxElement.setPrefix(e)}setCommandSuggestion(e){this.inputBoxElement.setSuggestion(e)}setHintElement(e){this.hintElement.textContent=e}setPromptTitle(e){o.ARIAUtils.setAccessibleName(this.inputBoxElement,e)}showAsDialog(e){e||(e=m(c.quickOpen)),this.dialog=new o.Dialog.Dialog,o.ARIAUtils.setAccessibleName(this.dialog.contentElement,e),this.dialog.setMaxContentSize(new o.Geometry.Size(504,340)),this.dialog.setSizeBehavior("SetExactWidthMaxHeight"),this.dialog.setContentPosition(null,22),this.dialog.contentElement.style.setProperty("border-radius","4px"),this.show(this.dialog.contentElement),o.ARIAUtils.setExpanded(this.contentElement,!0),this.dialog.once("hidden").then((()=>{this.dispatchEventToListeners("hidden")})),this.dialog.show()}setPrefix(e){this.prefix=e}setProvider(e){e!==this.provider&&(this.provider&&this.provider.detach(),this.clearTimers(),this.provider=e,this.isShowing()&&this.attachProvider())}setQuerySelectedRange(e,t){this.inputBoxElement.setSelectedRange(e,t)}attachProvider(){this.items.replaceAll([]),this.list.invalidateItemHeight(),this.provider&&(this.provider.setRefreshCallback(this.itemsLoaded.bind(this,this.provider)),this.provider.attach()),this.itemsLoaded(this.provider)}cleanValue(){return this.query.substring(this.prefix.length)}wasShown(){this.registerCSSFiles([d]),this.attachProvider()}willHide(){this.provider&&this.provider.detach(),this.clearTimers(),o.ARIAUtils.setExpanded(this.contentElement,!1)}clearTimers(){clearTimeout(this.filterTimer),clearTimeout(this.scoringTimer),clearTimeout(this.loadTimeout),this.filterTimer=0,this.scoringTimer=0,this.loadTimeout=0,this.refreshListWithCurrentResult=void 0}onEnter(e){if(!this.provider)return;e.preventDefault();const t=this.provider.itemCount()?this.list.selectedItem():null;this.selectItem(t),this.dialog&&this.dialog.hide()}itemsLoaded(e){this.loadTimeout||e!==this.provider||(this.loadTimeout=window.setTimeout(this.updateAfterItemsLoaded.bind(this),0))}updateAfterItemsLoaded(){this.loadTimeout=0,this.filterItems()}createElementForItem(e){const t=document.createElement("div");t.className="filtered-list-widget-item-wrapper";const i=t.createChild("div"),r=this.provider&&this.provider.renderAsTwoRows();i.className="filtered-list-widget-item "+(r?"two-rows":"one-row");const s=i.createChild("div","filtered-list-widget-title"),n=i.createChild("div","filtered-list-widget-subtitle");return n.textContent="â€‹",this.provider&&this.provider.renderItem(e,this.cleanValue(),s,n),o.ARIAUtils.markAsOption(i),t}heightForItem(e){return 0}isItemSelectable(e){return!0}selectedItemChanged(e,t,i,r){i&&i.classList.remove("selected"),r&&r.classList.add("selected"),o.ARIAUtils.setActiveDescendant(this.inputBoxElement,r)}onClick(e){const t=this.list.itemForNode(e.target);null!==t&&(e.consume(!0),this.selectItem(t),this.dialog&&this.dialog.hide())}onMouseOver(e){const t=this.list.itemForNode(e.target);null!==t&&this.list.selectItem(t)}setQuery(e){this.query=e,this.inputBoxElement.focus(),this.inputBoxElement.setText(e),this.queryChanged(),this.scheduleFilter()}tabKeyPressed(){const e=this.query;let t;for(let i=this.promptHistory.length-1;i>=0;i--)if(this.promptHistory[i]!==e&&this.promptHistory[i].startsWith(e)){t=this.promptHistory[i];break}if(t){const i=this.inputBoxElement.getComponentSelection();return i&&""!==i.toString().trim()?(this.setQuery(t),!0):(this.inputBoxElement.focus(),this.inputBoxElement.setText(t),this.setQuerySelectedRange(e.length,t.length),!0)}return this.list.selectNextItem(!0,!1)}itemsFilteredForTest(){}filterItems(){if(this.filterTimer=0,this.scoringTimer&&(clearTimeout(this.scoringTimer),this.scoringTimer=0,this.refreshListWithCurrentResult&&this.refreshListWithCurrentResult()),!this.provider)return this.bottomElementsContainer.classList.toggle("hidden",!0),void this.itemsFilteredForTest();this.bottomElementsContainer.classList.toggle("hidden",!1),this.progressBarElement.style.transform="scaleX(0)",this.progressBarElement.classList.remove("filtered-widget-progress-fade","hidden");const e=this.provider.rewriteQuery(this.cleanValue()),t=e?r.StringUtilities.filterRegex(e):null,i=[],s=[],o=[],n=100;let l=0;const a=[],d=window.performance.now(),c=r.NumberUtilities.clamp(10,500,this.provider.itemCount()/10|0);function h(e,t){return t-e}(function m(p){if(!this.provider)return;this.scoringTimer=0;let g,u=0;for(g=p;g<this.provider.itemCount()&&u<c;++g){if(t&&!t.test(this.provider.itemKeyAt(g)))continue;const d=this.provider.itemScoreAt(g,e);if(e&&u++,d>l||s.length<n){const e=r.ArrayUtilities.upperBound(s,d,h);if(s.splice(e,0,d),o.splice(e,0,g),s.length>n){const e=o[o.length-1];e&&a.push(e),s.length=n,o.length=n}const t=s[s.length-1];t&&(l=t)}else i.push(g)}if(this.refreshListWithCurrentResult=this.refreshList.bind(this,o,a,i),g<this.provider.itemCount())return this.scoringTimer=window.setTimeout(m.bind(this,g),0),void(window.performance.now()-d>50&&(this.progressBarElement.style.transform="scaleX("+g/this.provider.itemCount()+")"));window.performance.now()-d>100?(this.progressBarElement.style.transform="scaleX(1)",this.progressBarElement.classList.add("filtered-widget-progress-fade")):this.progressBarElement.classList.add("hidden");this.refreshListWithCurrentResult()}).call(this,0)}refreshList(e,t,i){this.refreshListWithCurrentResult=void 0,i=[...e,...t,...i],this.updateNotFoundMessage(Boolean(i.length));const r=this.list.element.offsetHeight;this.items.replaceAll(i),i.length&&this.list.selectItem(i[0]),this.list.element.offsetHeight!==r&&this.list.viewportResized(),this.itemsFilteredForTest()}updateNotFoundMessage(e){this.list.element.classList.toggle("hidden",!e),this.notFoundElement.classList.toggle("hidden",e),!e&&this.provider&&(this.notFoundElement.textContent=this.provider.notFoundText(this.cleanValue()),o.ARIAUtils.alert(this.notFoundElement.textContent))}onInput(e){this.query=e.data,this.queryChanged(),this.scheduleFilter()}async queryChanged(){this.queryChangedCallback&&await this.queryChangedCallback(this.query),this.provider&&this.provider.queryChanged(this.cleanValue())}updateSelectedItemARIA(e,t){return!1}onKeyDown(e){let t=!1;switch(e.key){case r.KeyboardUtilities.ENTER_KEY:return void this.onEnter(e);case r.KeyboardUtilities.TAB_KEY:t=this.tabKeyPressed();break;case"ArrowUp":t=this.list.selectPreviousItem(!0,!1);break;case"ArrowDown":t=this.list.selectNextItem(!0,!1);break;case"PageUp":t=this.list.selectItemPreviousPage(!1);break;case"PageDown":t=this.list.selectItemNextPage(!1)}t&&e.consume(!0)}scheduleFilter(){this.filterTimer||(this.filterTimer=window.setTimeout(this.filterItems.bind(this),0))}selectItem(e){this.promptHistory.push(this.query),this.promptHistory.length>100&&this.promptHistory.shift(),this.provider&&this.provider.selectItem(e,this.cleanValue())}}class g{refreshCallback;constructor(){}setRefreshCallback(e){this.refreshCallback=e}attach(){}itemCount(){return 0}itemKeyAt(e){return""}itemScoreAt(e,t){return 1}renderItem(e,t,i,r){}renderAsTwoRows(){return!1}selectItem(e,t){}refresh(){this.refreshCallback&&this.refreshCallback()}rewriteQuery(e){return e}queryChanged(e){}notFoundText(e){return m(c.noResultsFound)}detach(){}}const u=[];function f(e){u.push(e)}function w(){return u}var v=Object.freeze({__proto__:null,FilteredListWidget:p,Provider:g,registerProvider:f,getRegisteredProviders:w});const x={useTabToSwitchCommandsTypeToSeeAvailableCommands:"Use Tab to switch commands. Type '?' to see available commands"},C=i.i18n.registerUIStrings("ui/legacy/components/quick_open/QuickOpen.ts",x),y=i.i18n.getLocalizedString.bind(void 0,C),b=[];class E{prefix;prefixes;providers;filteredListWidget;constructor(){this.prefix=null,this.prefixes=[],this.providers=new Map,this.filteredListWidget=null,w().forEach(this.addProvider.bind(this)),this.prefixes.sort(((e,t)=>t.length-e.length))}static show(e){const t=new this,i=new p(null,b,t.queryChanged.bind(t));t.filteredListWidget=i,i.setHintElement(y(x.useTabToSwitchCommandsTypeToSeeAvailableCommands)),i.showAsDialog(),i.setQuery(e)}addProvider(e){const t=e.prefix;null!==t&&(this.prefixes.push(t),this.providers.set(t,{provider:e.provider,titlePrefix:e.titlePrefix,titleSuggestion:e.titleSuggestion}))}async queryChanged(e){const t=this.prefixes.find((t=>e.startsWith(t)));if("string"!=typeof t)return;if(!this.filteredListWidget)return;this.filteredListWidget.setPrefix(t);const i=this.providers.get(t)?.titlePrefix;this.filteredListWidget.setCommandPrefix(i?i():"");const r=e===t&&this.providers.get(t)?.titleSuggestion;if(this.filteredListWidget.setCommandSuggestion(r?r():""),this.prefix===t)return;this.prefix=t,this.filteredListWidget.setProvider(null);const s=this.providers.get(t)?.provider;if(!s)return;const o=await s();this.prefix===t&&this.filteredListWidget&&(this.filteredListWidget.setProvider(o),this.providerLoadedForTest(o))}providerLoadedForTest(e){}}let I;class k{static instance(e={forceNew:null}){const{forceNew:t}=e;return I&&!t||(I=new k),I}handleAction(e,t){return"quickOpen.show"===t&&(E.show(""),!0)}}var A=Object.freeze({__proto__:null,history:b,QuickOpenImpl:E,ShowActionDelegate:k});const T={oneOrMoreSettingsHaveChanged:"One or more settings have changed which requires a reload to take effect.",noCommandsFound:"No commands found",run:"Run",command:"Command"},S=i.i18n.registerUIStrings("ui/legacy/components/quick_open/CommandMenu.ts",T),L=i.i18n.getLocalizedString.bind(void 0,S);let R,P;class _{commandsInternal;constructor(){this.commandsInternal=[],this.loadCommands()}static instance(e={forceNew:null}){const{forceNew:t}=e;return R&&!t||(R=new _),R}static createCommand(e){const{category:i,keys:r,title:s,shortcut:o,executeHandler:n,availableHandler:l,userActionCode:a}=e;let d=n;if(a){const e=a;d=()=>{t.userMetrics.actionTaken(e),n()}}if("Show Issues"===s){const e=d;d=()=>{t.userMetrics.issuesPanelOpenedFrom(t.UserMetrics.IssueOpener.CommandMenu),e()}}return new D(i,s,r,o,d,l)}static createSettingCommand(t,i,r){const s=t.category();if(!s)throw new Error(`Creating '${i}' setting command failed. Setting has no category.`);const n=t.tags()||"",l=Boolean(t.reloadRequired());return _.createCommand({category:e.Settings.getLocalizedSettingsCategory(s),keys:n,title:i,shortcut:"",executeHandler:()=>{t.set(r),l&&o.InspectorView.InspectorView.instance().displayReloadRequiredWarning(L(T.oneOrMoreSettingsHaveChanged))},availableHandler:function(){return t.get()!==r},userActionCode:void 0})}static createActionCommand(e){const{action:t,userActionCode:i}=e,r=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutTitleForAction(t.id())||"";return _.createCommand({category:t.category(),keys:t.tags()||"",title:t.title()||"",shortcut:r,executeHandler:t.execute.bind(t),userActionCode:i,availableHandler:void 0})}static createRevealViewCommand(e){const{title:t,tags:i,category:r,userActionCode:s,id:n}=e;return _.createCommand({category:r,keys:i,title:t,shortcut:"",executeHandler:o.ViewManager.ViewManager.instance().showView.bind(o.ViewManager.ViewManager.instance(),n,!0),userActionCode:s,availableHandler:void 0})}loadCommands(){const t=new Map;for(const{category:e,name:i}of o.ViewManager.getRegisteredLocationResolvers())e&&i&&t.set(i,e);const i=o.ViewManager.getRegisteredViewExtensions();for(const e of i){const i=e.location(),r=i&&t.get(i);if(!r)continue;const s={title:e.commandPrompt(),tags:e.tags()||"",category:r,userActionCode:void 0,id:e.viewId()};this.commandsInternal.push(_.createRevealViewCommand(s))}const r=e.Settings.getRegisteredSettings();for(const t of r){const i=t.options;if(i&&t.category)for(const r of i){const i=e.Settings.Settings.instance().moduleSetting(t.settingName);this.commandsInternal.push(_.createSettingCommand(i,r.title(),r.value))}}}commands(){return this.commandsInternal}}class F extends g{commands;constructor(){super(),this.commands=[]}static instance(e={forceNew:null}){const{forceNew:t}=e;return P&&!t||(P=new F),P}attach(){const e=_.instance().commands(),t=o.ActionRegistry.ActionRegistry.instance().availableActions();for(const e of t){if(!e.category())continue;const t={action:e,userActionCode:void 0};this.commands.push(_.createActionCommand(t))}for(const t of e)t.available()&&this.commands.push(t);this.commands=this.commands.sort((function(e,t){const i=r.StringUtilities.compare(e.category(),t.category());return i||r.StringUtilities.compare(e.title(),t.title())}))}detach(){this.commands=[]}itemCount(){return this.commands.length}itemKeyAt(e){return this.commands[e].key()}itemScoreAt(e,t){const i=this.commands[e];let r=s.Diff.DiffWrapper.characterScore(t.toLowerCase(),i.title().toLowerCase());return i.category().startsWith("Panel")?r+=2:i.category().startsWith("Drawer")&&(r+=1),r}renderItem(e,t,i,s){const n=this.commands[e];i.removeChildren(),o.UIUtils.createTextChild(i,n.title()),p.highlightRanges(i,t,!0),s.textContent=n.shortcut();const l=i.parentElement?.parentElement?.createChild("span","tag");if(!l)return;const a=r.StringUtilities.hashCode(n.category())%H.length;l.style.backgroundColor=H[a],l.style.color="var(--color-background)",l.textContent=n.category()}selectItem(e,i){null!==e&&(this.commands[e].execute(),t.userMetrics.actionTaken(t.UserMetrics.Action.SelectCommandFromCommandMenu))}notFoundText(){return L(T.noCommandsFound)}}const H=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFC107","#FF9800","#FF5722","#795548","#9E9E9E","#607D8B"];class D{categoryInternal;titleInternal;keyInternal;shortcutInternal;executeHandler;availableHandler;constructor(e,t,i,r,s,o){this.categoryInternal=e,this.titleInternal=t,this.keyInternal=e+"\0"+t+"\0"+i,this.shortcutInternal=r,this.executeHandler=s,this.availableHandler=o}category(){return this.categoryInternal}title(){return this.titleInternal}key(){return this.keyInternal}shortcut(){return this.shortcutInternal}available(){return!this.availableHandler||this.availableHandler()}execute(){this.executeHandler()}}let B;class U{static instance(e={forceNew:null}){const{forceNew:t}=e;return B&&!t||(B=new U),B}handleAction(e,i){return t.InspectorFrontendHost.InspectorFrontendHostInstance.bringToFront(),E.show(">"),!0}}f({prefix:">",iconName:"ic_command_run_command",provider:()=>Promise.resolve(F.instance()),titlePrefix:()=>L(T.run),titleSuggestion:()=>L(T.command)});var O=Object.freeze({__proto__:null,CommandMenu:_,CommandMenuProvider:F,MaterialPaletteColors:H,Command:D,ShowActionDelegate:U});let N;class q extends g{providers;constructor(){super(),this.providers=[],w().forEach(this.addProvider.bind(this))}static instance(e={forceNew:null}){const{forceNew:t}=e;return N&&!t||(N=new q),N}addProvider(e){e.titleSuggestion&&this.providers.push({prefix:e.prefix||"",iconName:e.iconName,title:e.titlePrefix()+" "+e.titleSuggestion()})}itemCount(){return this.providers.length}itemKeyAt(e){return this.providers[e].prefix}itemScoreAt(e,t){return-this.providers[e].prefix.length}renderItem(e,t,i,r){const s=this.providers[e],n=new a.Icon.Icon;n.data={iconName:s.iconName,color:"var(--color-text-primary)",width:"18px",height:"18px"},i.parentElement?.parentElement?.insertBefore(n,i.parentElement),o.UIUtils.createTextChild(i,s.title)}selectItem(e,t){null!==e&&E.show(this.providers[e].prefix)}renderAsTwoRows(){return!1}}f({prefix:"?",iconName:"ic_command_help",provider:()=>Promise.resolve(q.instance()),titlePrefix:()=>"Help",titleSuggestion:void 0});var W=Object.freeze({__proto__:null,HelpQuickOpen:q});const M={pressEnterToConfirmOrEscapeTo:"{PH1} (Press 'Enter' to confirm or 'Escape' to cancel.)"},Q=i.i18n.registerUIStrings("ui/legacy/components/quick_open/QuickInput.ts",M),z=i.i18n.getLocalizedString.bind(void 0,Q);class V extends g{options;resolve;constructor(e,t){super(),this.options=e,this.resolve=t}notFoundText(){return z(M.pressEnterToConfirmOrEscapeTo,{PH1:this.options.prompt})}selectItem(e,t){this.resolve(t)}}var j=Object.freeze({__proto__:null,QuickInput:class{constructor(){throw new ReferenceError("Instance type not implemented.")}static show(e){let t=new Promise((e=>{}));const i=new Promise((i=>{const r=new V(e,i),s=new p(r);e.placeHolder&&s.setHintElement(e.placeHolder),s.setPromptTitle(e.placeHolder||e.prompt),s.showAsDialog(e.prompt),t=s.once("hidden"),s.setQuery(e.value||""),e.valueSelection&&s.setQuerySelectedRange(e.valueSelection[0],e.valueSelection[1])}));return Promise.race([i,t]).then((e=>e))}}});class K extends g{resolve;items;matchOnDescription;matchOnDetail;constructor(e,t,i=.5,r=.25){super(),this.resolve=t,this.items=e,this.matchOnDescription=i,this.matchOnDetail=r}itemCount(){return this.items.length}itemKeyAt(e){const t=this.items[e];let i=t.label;return this.matchOnDescription&&(i+=" "+t.description),this.matchOnDetail&&(i+=" "+t.detail),i}itemScoreAt(e,t){const i=this.items[e],r=t.toLowerCase();let o=s.Diff.DiffWrapper.characterScore(r,i.label.toLowerCase());if(this.matchOnDescription&&i.description){o+=s.Diff.DiffWrapper.characterScore(r,i.description.toLowerCase())*this.matchOnDescription}if(this.matchOnDetail&&i.detail){o+=s.Diff.DiffWrapper.characterScore(r,i.detail.toLowerCase())*this.matchOnDetail}return o}renderItem(e,t,i,r){const s=this.items[e];i.removeChildren();const n=i.createChild("span");if(o.UIUtils.createTextChild(n,s.label),p.highlightRanges(i,t,!0),s.description){const e=i.createChild("span","quickpick-description");o.UIUtils.createTextChild(e,s.description),this.matchOnDescription&&p.highlightRanges(e,t,!0)}s.detail&&(o.UIUtils.createTextChild(r,s.detail),this.matchOnDetail&&p.highlightRanges(r,t,!0))}renderAsTwoRows(){return this.items.some((e=>Boolean(e.detail)))}selectItem(e,t){"number"!=typeof e?this.resolve(void 0):this.resolve(this.items[e])}}var X=Object.freeze({__proto__:null,QuickPick:class{constructor(){throw new ReferenceError("Instance type not implemented.")}static show(e,t){let i=new Promise((e=>{}));const r=new Promise((r=>{const s=new K(e,r,t.matchOnDescription?.5:0,t.matchOnDetail?.25:0),o=new p(s);o.setHintElement(t.placeHolder),o.setPromptTitle(t.placeHolder),o.showAsDialog(t.placeHolder),i=o.once("hidden"),o.setQuery("")}));return Promise.race([r,i]).then((e=>e))}}});export{O as CommandMenu,v as FilteredListWidget,W as HelpQuickOpen,j as QuickInput,A as QuickOpen,X as QuickPick};
